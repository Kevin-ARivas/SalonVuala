{% load static %}

<!-- GSAP -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

<nav class="bg-white text-black shadow-md">

    <div class="max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8">

        <!-- NAV WRAPPER PARA ANIMACIONES -->
        <div class="gsap-nav-wrapper flex justify-between h-20 items-center gap-12 opacity-0">

            <!-- Logo -->
            <div class="flex-shrink-0 flex items-center">
                <div class="gsap-logo">
                    <a href="{% url 'dashboard' %}"
                        class="text-3xl font-bold tracking-tight hover:text-pink-400 transition-colors">
                        ✄ Salón Vualá
                    </a>
                </div>
            </div>

            <!-- Links (Desktop) -->
            <div class="hidden md:flex md:items-center space-x-10">

                <div class="flex items-center space-x-8">

                    {% if request.user.tipo_usuario == 'admin' %}
                    <div class="gsap-nav-item">
                        <a href="{% url 'pagina_inicio' %}"
                            class="hover:text-white hover:bg-black font-bold rounded-md px-5 py-3 transition-colors">Clientes</a>
                    </div>

                    <div class="gsap-nav-item">
                        <a href="{% url 'admin:index' %}"
                            class="hover:text-white hover:bg-black font-bold rounded-md px-5 py-3 transition-colors">Admin</a>
                    </div>
                    {% endif %}

                    <div class="gsap-nav-item">
                        <a href="{% url 'citas' %}"
                            class="hover:text-white hover:bg-black font-bold rounded-md px-5 py-3 transition-colors">Citas</a>
                    </div>

                    <div class="gsap-nav-item">
                        <a href="{% url 'lista_servicios' %}"
                            class="hover:text-white hover:bg-black font-bold rounded-md px-5 py-3 transition-colors">Servicios</a>
                    </div>

                    <div class="gsap-nav-item">
                        <a href="{% url 'inventario' %}"
                            class="hover:text-white hover:bg-black font-bold rounded-md px-5 py-3 transition-colors">Inventario</a>
                    </div>

                    <div class="gsap-nav-item">
                        <a href="{% url 'finanzas' %}"
                            class="hover:text-white hover:bg-black font-bold rounded-md px-5 py-3 transition-colors">Finanzas</a>
                    </div>

                    <div class="gsap-nav-item">
                        <a href="{% url 'reportes' %}"
                            class="hover:text-white hover:bg-black font-bold rounded-md px-5 py-3 transition-colors">Reportes</a>
                    </div>

                </div>
            </div>

            <!-- Usuario / Login -->
            <div class="hidden md:flex md:items-center gsap-user-box">
                {% if request.user.is_authenticated %}
                <span class="mr-6 text-blue-800 font-medium text-lg">Hola, {{ request.user.first_name|default:request.user.username }}</span>
                <a href="{% url 'logout_usuario' %}"
                    class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition-colors">Cerrar sesión</a>
                {% else %}
                <a href=""
                    class="bg-black text-white font-bold px-4 py-2 rounded hover:bg-pink-400 transition-colors">Iniciar
                    sesión</a>
                {% endif %}
            </div>

            <!-- Botón móvil -->
            <div class="flex items-center md:hidden">
                <button id="menu-btn" class="focus:outline-none focus:ring-2 focus:ring-pink-400">
                    <svg class="h-8 w-8" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>
            </div>

        </div>
    </div>

    <!-- Menú móvil -->
    <div id="mobile-menu" class="hidden md:hidden bg-gray-800">

        {% if request.user.tipo_usuario == 'admin' %}
        <div class="gsap-mobile-item">
            <a href="{% url 'pagina_inicio' %}" class="block px-4 py-3 hover:bg-gray-700">Clientes</a>
        </div>
        <div class="gsap-mobile-item">
            <a href="{% url 'admin:index' %}" class="block px-4 py-3 hover:bg-gray-700">Admin Panel</a>
        </div>
        {% endif %}

        <div class="gsap-mobile-item">
            <a href="{% url 'dashboard' %}" class="block px-4 py-3 hover:bg-gray-700">Dashboard</a>
        </div>

        <div class="gsap-mobile-item">
            <a href="{% url 'citas' %}" class="block px-4 py-3 hover:bg-gray-700">Citas</a>
        </div>

        <div class="gsap-mobile-item">
            <a href="{% url 'lista_servicios' %}" class="block px-4 py-3 hover:bg-gray-700">Servicios</a>
        </div>

        <div class="gsap-mobile-item">
            <a href="{% url 'inventario' %}" class="block px-4 py-3 hover:bg-gray-700">Inventario</a>
        </div>

        <div class="gsap-mobile-item">
            <a href="{% url 'finanzas' %}" class="block px-4 py-3 hover:bg-gray-700">Finanzas</a>
        </div>

        <div class="gsap-mobile-item">
            <a href="{% url 'reportes' %}" class="block px-4 py-3 hover:bg-gray-700">Reportes</a>
        </div>

        <div class="border-t border-gray-700 mt-2">

            {% if request.user.is_authenticated %}
            <div class="gsap-mobile-item">
                <span class="block px-4 py-3 text-white">
                    Hola, {{ request.user.first_name|default:request.user.username }}
                </span>
            </div>

            <div class="gsap-mobile-item">
                <a href="{% url 'logout_usuario' %}" class="block px-4 py-3 text-red-500 hover:text-red-400">Cerrar
                    sesión</a>
            </div>

            {% else %}
            <div class="gsap-mobile-item">
                <a href="" class="block px-4 py-3 text-indigo-400 hover:text-indigo-300">Iniciar sesión</a>
            </div>
            {% endif %}

        </div>
    </div>

</nav>

<!-- GSAP ANIMACIONES -->
<script>
    // Animación inicial del navbar
    gsap.to(".gsap-nav-wrapper", {
        opacity: 1,
        y: 0,
        duration: 0.8,
        ease: "power3.out"
    });

    // Logo animado
    gsap.from(".gsap-logo", {
        opacity: 0,
        y: -20,
        duration: 0.7,
        delay: 0.1,
        ease: "power2.out"
    });

    // Links animados
    gsap.from(".gsap-nav-item", {
        opacity: 0,
        y: 15,
        duration: 0.6,
        stagger: 0.08,
        delay: 0.2,
        ease: "power2.out"
    });

    // User box animado
    gsap.from(".gsap-user-box", {
        opacity: 0,
        y: -10,
        duration: 0.7,
        delay: 0.3,
        ease: "power2.out"
    });

    // Animación del menú móvil al abrir
    const menuBtn = document.getElementById("menu-btn");
    const mobileMenu = document.getElementById("mobile-menu");

    menuBtn.addEventListener("click", () => {
        mobileMenu.classList.toggle("hidden");

        if (!mobileMenu.classList.contains("hidden")) {
            gsap.from(".gsap-mobile-item", {
                opacity: 0,
                x: -20,
                duration: 0.3,
                stagger: 0.07,
                ease: "power2.out"
            });
        }
    });
</script>